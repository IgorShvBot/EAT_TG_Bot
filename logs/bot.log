28-04-2025 11:04:51 - root - INFO - Запуск бота в Docker-контейнере
28-04-2025 11:04:51 - telegram.ext.Application - INFO - Application started
28-04-2025 11:06:14 - root - INFO - Получен файл: ДДС_Яндекс.pdf
28-04-2025 11:06:14 - root - INFO - Начата обработка PDF: ДДС_Яндекс.pdf, размер: 127126 байт
28-04-2025 11:06:14 - root - INFO - Используются настройки: return_files=0
28-04-2025 11:06:15 - extract_transactions_pdf2 - INFO - Обработка CSV как Yandex
28-04-2025 11:06:15 - extract_transactions_pdf2 - INFO - Успешно загружен CSV для Yandex, строк: 135
28-04-2025 11:06:15 - extract_transactions_pdf2 - INFO - Данные сохранены в /tmp/transactions_processed_yandex.csv
28-04-2025 11:07:41 - root - INFO - Получен файл: ДДС_Яндекс.pdf
28-04-2025 11:07:41 - root - INFO - Начата обработка PDF: ДДС_Яндекс.pdf, размер: 127126 байт
28-04-2025 11:07:41 - root - INFO - Используются настройки: return_files=0
28-04-2025 11:07:41 - extract_transactions_pdf2 - INFO - Обработка CSV как Yandex
28-04-2025 11:07:41 - extract_transactions_pdf2 - INFO - Успешно загружен CSV для Yandex, строк: 135
28-04-2025 11:07:41 - extract_transactions_pdf2 - INFO - Данные сохранены в /tmp/transactions_processed_yandex.csv
28-04-2025 11:07:41 - classify_transactions_pdf - ERROR - Ошибка классификации транзакций: 'чек #'
28-04-2025 11:07:41 - root - ERROR - Ошибка обработки PDF: 'чек #'
Traceback (most recent call last):
  File "/root/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'чек #'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/bot.py", line 895, in handle_document
    result_csv_path, unclassified_csv_path = await asyncio.to_thread(
  File "/usr/local/lib/python3.10/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
  File "/usr/local/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/app/classify_transactions_pdf.py", line 168, in classify_transactions
    result[column_name] = result[column_name].astype(str) + ' ' + setting_value['value']
  File "/root/.local/lib/python3.10/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/root/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: 'чек #'
28-04-2025 11:31:11 - root - INFO - Запуск бота в Docker-контейнере
28-04-2025 11:31:11 - telegram.ext.Application - INFO - Application started
28-04-2025 11:34:59 - root - INFO - Получен файл: ДДС_Яндекс.pdf
28-04-2025 11:35:00 - root - INFO - Начата обработка PDF: ДДС_Яндекс.pdf, размер: 127126 байт
28-04-2025 11:35:00 - root - INFO - Используются настройки: return_files=0
28-04-2025 11:35:00 - extract_transactions_pdf2 - INFO - Обработка CSV как Yandex
28-04-2025 11:35:00 - extract_transactions_pdf2 - INFO - Успешно загружен CSV для Yandex, строк: 135
28-04-2025 11:35:00 - extract_transactions_pdf2 - INFO - Данные сохранены в /tmp/transactions_processed_yandex.csv
28-04-2025 11:36:51 - root - INFO - Получен файл: ДДС_Яндекс.pdf
28-04-2025 11:36:51 - root - INFO - Начата обработка PDF: ДДС_Яндекс.pdf, размер: 127126 байт
28-04-2025 11:36:51 - root - INFO - Используются настройки: return_files=0
28-04-2025 11:36:52 - extract_transactions_pdf2 - INFO - Обработка CSV как Yandex
28-04-2025 11:36:52 - extract_transactions_pdf2 - INFO - Успешно загружен CSV для Yandex, строк: 135
28-04-2025 11:36:52 - extract_transactions_pdf2 - INFO - Данные сохранены в /tmp/transactions_processed_yandex.csv
28-04-2025 11:37:59 - root - INFO - Получен файл: ДДС_Яндекс.pdf
28-04-2025 11:37:59 - root - INFO - Начата обработка PDF: ДДС_Яндекс.pdf, размер: 127126 байт
28-04-2025 11:37:59 - root - INFO - Используются настройки: return_files=0
28-04-2025 11:37:59 - extract_transactions_pdf2 - INFO - Обработка CSV как Yandex
28-04-2025 11:37:59 - extract_transactions_pdf2 - INFO - Успешно загружен CSV для Yandex, строк: 135
28-04-2025 11:37:59 - extract_transactions_pdf2 - INFO - Данные сохранены в /tmp/transactions_processed_yandex.csv
28-04-2025 13:38:20 - root - INFO - Запуск бота в Docker-контейнере
28-04-2025 13:38:20 - telegram.ext.Application - INFO - Application started
28-04-2025 13:39:20 - root - INFO - Получен файл: ДДС_Яндекс.pdf
28-04-2025 13:39:20 - root - INFO - Начата обработка PDF: ДДС_Яндекс.pdf, размер: 127126 байт
28-04-2025 13:39:20 - root - INFO - Используются настройки: return_files=0
28-04-2025 13:39:20 - extract_transactions_pdf2 - INFO - Обработка CSV как Yandex
28-04-2025 13:39:20 - extract_transactions_pdf2 - INFO - Успешно загружен CSV для Yandex, строк: 135
28-04-2025 13:39:20 - extract_transactions_pdf2 - INFO - Данные сохранены в /tmp/transactions_processed_yandex.csv
28-04-2025 13:40:26 - root - INFO - Получен файл: ДДС_Яндекс.pdf
28-04-2025 13:40:26 - root - INFO - Начата обработка PDF: ДДС_Яндекс.pdf, размер: 127126 байт
28-04-2025 13:40:26 - root - INFO - Используются настройки: return_files=0
28-04-2025 13:40:27 - extract_transactions_pdf2 - INFO - Обработка CSV как Yandex
28-04-2025 13:40:27 - extract_transactions_pdf2 - INFO - Успешно загружен CSV для Yandex, строк: 135
28-04-2025 13:40:27 - extract_transactions_pdf2 - INFO - Данные сохранены в /tmp/transactions_processed_yandex.csv
28-04-2025 13:43:35 - root - INFO - Запуск бота в Docker-контейнере
28-04-2025 13:43:35 - telegram.ext.Application - INFO - Application started
28-04-2025 13:44:10 - root - INFO - Получен файл: ДДС_Яндекс.pdf
28-04-2025 13:44:10 - root - INFO - Начата обработка PDF: ДДС_Яндекс.pdf, размер: 127126 байт
28-04-2025 13:44:10 - root - INFO - Используются настройки: return_files=0
28-04-2025 13:44:11 - extract_transactions_pdf2 - INFO - Обработка CSV как Yandex
28-04-2025 13:44:11 - extract_transactions_pdf2 - INFO - Успешно загружен CSV для Yandex, строк: 135
28-04-2025 13:44:11 - extract_transactions_pdf2 - INFO - Данные сохранены в /tmp/transactions_processed_yandex.csv
